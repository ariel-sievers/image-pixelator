function getPixelationFactor(){const factor=document.querySelector(".factor__range").value/100;return factor}function pixelate(){if(!document.getElementById("img--original"))return;var ctx=document.getElementById("canvas").getContext("2d");const src=document.getElementById("img--original").src,size=100*getPixelationFactor(),img=new Image;img.src=src,img.onload=function(){const downloadButton=document.getElementById("download"),height=Math.ceil(img.height/size)*size,width=Math.ceil(img.width/size)*size,small={height:height/size,width:width/size};var canvas=ctx.canvas;canvas.width=width,canvas.height=height,ctx.mozImageSmoothingEnabled=!1,ctx.webkitImageSmoothingEnabled=!1,ctx.imageSmoothingEnabled=!1,ctx.drawImage(img,0,0,small.width,small.height),ctx.rect(0,0,width,height),ctx.drawImage(canvas,0,0,small.width,small.height,0,0,width,height);const url=canvas.toDataURL();document.getElementById("img--pixelated").setAttribute("src",url),downloadButton.setAttribute("href",url),downloadButton.classList.remove("flex__item--hidden"),ctx.clearRect(0,0,width,height),canvas.width=0,canvas.height=0}}window.addEventListener("load",(function(){const pixelateButton=document.querySelector(".btn__pixelate"),downloadButton=document.getElementById("download"),factorValue=document.querySelector(".factor__range"),factorOutput=document.querySelector(".factor__output");factorOutput.innerHTML=`${factorValue.value}%`,document.querySelector('input[type="file"]').addEventListener("change",(function(){if(this.files&&this.files[0]){const src=URL.createObjectURL(this.files[0]),img=document.getElementById("img--original"),pixelated=document.getElementById("img--pixelated");"#"!==pixelated.src&&(pixelated.src="#",downloadButton.setAttribute("download",`pixelated_${this.files[0].name}`),downloadButton.classList.add("flex__item--hidden")),img.src=src,document.querySelector(".grid__item--hidden")&&document.querySelector(".grid__item--hidden").classList.remove("grid__item--hidden")}})),pixelateButton.addEventListener("click",pixelate),factorValue.addEventListener("input",(function(){factorOutput.innerHTML=`${this.value}%`}))}));